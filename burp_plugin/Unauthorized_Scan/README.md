@@ -0,0 +1,95 @@
# 未授权访问检测器 (Unauthorized Access Detector)

这是一个Burp Suite扩展工具，用于自动检测Web应用程序中的未授权访问漏洞。

## 功能介绍

未授权访问漏洞是Web应用中常见的安全问题，当应用程序未正确验证用户权限就允许访问敏感资源时，就会出现这类漏洞。本插件通过以下方式检测这类漏洞：

1. **自动移除认证头**：从HTTP请求中移除认证相关的头部信息（如 Authorization、Cookie、X-Auth-Token 等）
2. **比较响应差异**：分析原始响应与未授权响应的内容差异
3. **智能判断漏洞**：根据响应状态码、响应长度等因素自动判断是否存在未授权访问漏洞

## 主要特性

- **主动扫描和被动扫描模式**：支持在Burp主动扫描中使用，也可以被动监控所有流量
- **自定义认证头**：可配置需要移除的认证头列表
- **可调整的检测阈值**：可设置响应长度差异阈值，灵活适应不同应用场景
- **详细的调试信息**：提供完整的请求处理日志，便于排查问题
- **强大的错误处理**：包含请求重试机制，确保检测过程稳定可靠
- **丰富的结果展示**：直观查看检测结果及详细信息
- **导出功能**：支持将检测结果导出为Markdown或文本文件
- **流量记录**：记录所有经过的流量，便于后续分析

## 安装方法

1. 下载最新的release版本JAR文件（`unauthorized-access-detector-1.0-shaded.jar`）
2. 打开Burp Suite，进入Extender > Extensions
3. 点击"Add"按钮，选择下载的JAR文件
4. 成功加载后，在顶部标签中会出现"Unauthorized Scan"选项卡

## 使用说明

### 基本配置

1. 在"需要删除的认证头"文本框中配置要移除的认证头（每行一个）
2. 设置响应长度差异阈值（默认50字节）
3. 选择是否启用主动扫描、被动扫描等功能

### 检测未授权访问漏洞

**被动扫描模式**：
- 启用"启用插件"和"启用被动扫描"选项
- 正常浏览目标应用，插件会自动检测所有经过的流量

**主动扫描模式**：
- 启用"启用插件"和"启用主动扫描"选项
- 在Burp Scanner中进行主动扫描时，插件会自动运行检测

### 查看结果

- "未授权漏洞"选项卡显示检测到的漏洞
- "所有流量"选项卡记录所有经过的流量及其未授权测试结果
- 选择列表中的项目可在下方查看详细的请求和响应信息

### 导出结果

- 点击"导出为MD文档"按钮可将结果以Markdown格式导出
- 点击"导出为TXT"按钮可将结果以文本格式导出

## 构建方法

如需从源码构建插件：

1. 确保已安装Java JDK 8+和Maven
2. 克隆本仓库到本地
3. 运行`build.bat`或执行以下命令：

```
mvn clean package
```

构建完成后，JAR文件将生成在`target`目录下

## 使用效果

![image-20250516034614482](./assets/image-20250516034614482.png)

进一步判断

![image-20250516034642361](./assets/image-20250516034642361.png)

## 注意事项

- 本工具仅用于安全测试和授权的渗透测试
- 使用本工具检测非授权系统可能违反相关法律法规
- 插件可能会增加网络流量，影响Burp Suite性能，请根据需要开启/关闭

## 更新日志

### v1.0 (2025-05-16)
- 首次发布
- 支持主动和被动扫描模式
- 提供可配置的认证头和检测阈值
- 实现详细的日志记录和错误处理
- 增加结果导出和流量记录功能 