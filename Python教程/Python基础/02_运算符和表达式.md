# Python 运算符和表达式

## 概述

本文档详细介绍了 Python 中的各种运算符和表达式，包括算术运算符、比较运算符、赋值运算符、逻辑运算符、位运算符、成员运算符、身份运算符以及它们的优先级和使用方法。理解这些运算符和表达式对于编写高效的 Python 代码至关重要。

## 算术运算符

算术运算符用于执行基本的数学运算。

| 运算符 | 描述 | 示例 |
| ------ | ---- | ---- |
| `+` | 加法 | `a + b` |
| `-` | 减法 | `a - b` |
| `*` | 乘法 | `a * b` |
| `/` | 除法（返回浮点数） | `a / b` |
| `//` | 整除（返回整数） | `a // b` |
| `%` | 取余 | `a % b` |
| `**` | 幂运算 | `a ** b` |

```python
a = 10
b = 3

print("加法 a + b =", a + b)       # 结果: 13
print("减法 a - b =", a - b)       # 结果: 7
print("乘法 a * b =", a * b)       # 结果: 30
print("除法 a / b =", a / b)       # 结果: 3.3333333333333335
print("整除 a // b =", a // b)     # 结果: 3
print("取余 a % b =", a % b)       # 结果: 1
print("幂运算 a ** b =", a ** b)   # 结果: 1000
```

## 比较运算符

比较运算符用于比较两个值，返回布尔值（`True` 或 `False`）。

| 运算符 | 描述 | 示例 |
| ------ | ---- | ---- |
| `==` | 等于 | `a == b` |
| `!=` | 不等于 | `a != b` |
| `>` | 大于 | `a > b` |
| `<` | 小于 | `a < b` |
| `>=` | 大于等于 | `a >= b` |
| `<=` | 小于等于 | `a <= b` |

```python
a = 10
b = 3

print("等于 a == b:", a == b)       # 结果: False
print("不等于 a != b:", a != b)     # 结果: True
print("大于 a > b:", a > b)         # 结果: True
print("小于 a < b:", a < b)         # 结果: False
print("大于等于 a >= b:", a >= b)   # 结果: True
print("小于等于 a <= b:", a <= b)   # 结果: False
```

## 赋值运算符

赋值运算符用于给变量赋值。

| 运算符 | 描述 | 示例 |
| ------ | ---- | ---- |
| `=` | 简单赋值 | `x = 5` |
| `+=` | 加法赋值 | `x += 3` 等同于 `x = x + 3` |
| `-=` | 减法赋值 | `x -= 2` 等同于 `x = x - 2` |
| `*=` | 乘法赋值 | `x *= 4` 等同于 `x = x * 4` |
| `/=` | 除法赋值 | `x /= 2` 等同于 `x = x / 2` |
| `//=` | 整除赋值 | `x //= 2` 等同于 `x = x // 2` |
| `%=` | 取余赋值 | `x %= 3` 等同于 `x = x % 3` |
| `**=` | 幂赋值 | `x **= 2` 等同于 `x = x ** 2` |

```python
x = 5
print("初始值 x =", x)  # 结果: 5

x += 3
print("x += 3 后，x =", x)  # 结果: 8

x -= 2
print("x -= 2 后，x =", x)  # 结果: 6
```

## 逻辑运算符

逻辑运算符用于组合条件表达式。

| 运算符 | 描述 | 示例 |
| ------ | ---- | ---- |
| `and` | 逻辑与：两者都为 True 时结果为 True | `p and q` |
| `or` | 逻辑或：至少一个为 True 时结果为 True | `p or q` |
| `not` | 逻辑非：取反 | `not p` |

```python
p = True
q = False

print("与运算 p and q:", p and q)   # 结果: False
print("或运算 p or q:", p or q)     # 结果: True
print("非运算 not p:", not p)       # 结果: False
print("非运算 not q:", not q)       # 结果: True
```

### 逻辑运算符的短路特性

逻辑运算符具有短路特性，这意味着如果第一个操作数已经能够确定结果，则不会评估第二个操作数。

```python
# 由于 or 前面已经是 True，后面的表达式不会被执行
result1 = True or print("这不会被打印")

# 由于 and 前面已经是 False，后面的表达式不会被执行
result2 = False and print("这不会被打印")
```

## 位运算符

位运算符用于对整数的二进制位进行操作。

| 运算符 | 描述 | 示例 |
| ------ | ---- | ---- |
| `&` | 按位与 | `c & d` |
| `|` | 按位或 | `c | d` |
| `^` | 按位异或 | `c ^ d` |
| `~` | 按位取反 | `~c` |
| `<<` | 左移 | `c << 2` |
| `>>` | 右移 | `c >> 2` |

```python
c = 60      # 二进制：0011 1100
d = 13      # 二进制：0000 1101

print("按位与 c & d =", c & d)       # 结果: 12 (0000 1100)
print("按位或 c | d =", c | d)       # 结果: 61 (0011 1101)
print("按位异或 c ^ d =", c ^ d)     # 结果: 49 (0011 0001)
print("按位取反 ~c =", ~c)           # 结果: -61
print("左移 c << 2 =", c << 2)      # 结果: 240 (1111 0000)
print("右移 c >> 2 =", c >> 2)      # 结果: 15 (0000 1111)
```

## 成员运算符

成员运算符用于测试序列中是否存在指定的值。

| 运算符 | 描述 | 示例 |
| ------ | ---- | ---- |
| `in` | 如果在指定的序列中找到值，返回 True | `3 in my_list` |
| `not in` | 如果在指定的序列中没有找到值，返回 True | `4 not in my_list` |

```python
my_list = [1, 3, 5, 7, 9]

print("3 in my_list:", 3 in my_list)           # 结果: True
print("4 in my_list:", 4 in my_list)           # 结果: False
print("4 not in my_list:", 4 not in my_list)   # 结果: True
```

## 身份运算符

身份运算符用于比较两个对象的内存地址是否相同。

| 运算符 | 描述 | 示例 |
| ------ | ---- | ---- |
| `is` | 判断两个标识符是否引用同一个对象 | `a is b` |
| `is not` | 判断两个标识符是否引用不同的对象 | `a is not b` |

```python
a = [1, 2, 3]
b = [1, 2, 3]
c = a

print("a is b:", a is b)       # 结果: False（不同对象，值相同）
print("a is c:", a is c)       # 结果: True（同一对象）
print("a is not b:", a is not b)   # 结果: True
```

## 运算符优先级

Python 中的运算符按照一定的优先级进行计算，优先级从高到低的顺序大致如下：

1. 括号 `()`
2. 幂运算 `**`
3. 一元运算符 `+x`, `-x`, `~x`
4. 乘除模 `*`, `/`, `//`, `%`
5. 加减 `+`, `-`
6. 移位 `<<`, `>>`
7. 按位与 `&`
8. 按位异或 `^`
9. 按位或 `|`
10. 比较运算符 `==`, `!=`, `>`, `>=`, `<`, `<=`
11. 逻辑非 `not`
12. 逻辑与 `and`
13. 逻辑或 `or`
14. 条件表达式 `if-else`
15. 赋值运算符 `=`, `+=`, `-=` 等

```python
result = 5 + 3 * 2        # 结果: 11（乘法优先级高于加法）
result = (5 + 3) * 2      # 结果: 16（括号内的运算优先执行）
result = 10 / 2 + 3       # 结果: 8.0（除法优先级高于加法）
result = 10 / (2 + 3)     # 结果: 2.0（括号内的运算优先执行）
result = 4 ** 2 ** 3      # 结果: 65536（幂运算是从右向左结合的，等价于4 ** (2 ** 3)）
```

## 表达式

表达式是由值、变量、运算符和函数调用组成的组合。Python 支持多种类型的表达式：

### 算术表达式

```python
arithmetic_expr = (10 + 5) * 2 / 5  # 结果: 6.0
```

### 比较表达式

```python
comparison_expr = 10 > 5 and 7 < 12  # 结果: True
```

### 三元表达式（条件表达式）

```python
x = 10
y = 20
max_value = x if x > y else y  # 结果: 20
```

### 列表推导式

```python
numbers = [1, 2, 3, 4, 5]
squares = [x**2 for x in numbers]  # 结果: [1, 4, 9, 16, 25]
```

### 带条件的列表推导式

```python
even_squares = [x**2 for x in numbers if x % 2 == 0]  # 结果: [4, 16]
```

### 字典推导式

```python
dict_comp = {x: x**2 for x in range(1, 6)}  # 结果: {1: 1, 2: 4, 3: 9, 4: 16, 5: 25}
```

### 集合推导式

```python
set_comp = {x**2 for x in range(1, 6)}  # 结果: {1, 4, 9, 16, 25}
```

### 生成器表达式

```python
gen_expr = (x**2 for x in range(1, 6))  # 返回生成器对象
```

## 总结

本文档详细介绍了 Python 中的各种运算符和表达式，包括它们的语法、用法和优先级。理解这些运算符和表达式对于编写高效的 Python 代码至关重要。通过合理使用运算符和表达式，可以使代码更加简洁、高效和易于理解。