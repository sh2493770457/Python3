### 边界带理

#### 正向代理

- 用于代表`内部网络用户`向`外部服务器`发出连接请求,并接受响应结果,执行`代理功能的服务器`称为代理服务器
- 使用代理服务器访问外部网络时,客户端必须在局域网设置中指明`代理服务器的地址`以及要代理的服务`端口号`
- 代理`客户端`,`隐藏真实客户`,为客户端收发请求,使真实客户端对服务器不可见
- 一个局域网内的所有用户可能被一台服务器做了正向代理,由该服务器负责http请求

****

#### 反向代理

- 代表`外部网络`用户向`内部服务器发出请求`,即接收来自外部服务器的连接请求,并将这些请求`转发给内部网络上的服务器`,然后将从内部服务器上`得到的响应返回给外部的请求连接客户`
- 执行反向代理服务的服务器称为反向代理服务器,反向代理服务器对外部用户`表现为一个服务器`

- 代理`服务器`,`隐藏真实服务器`,将用户的请求分发到空闲的服务器上
- 用户和负载均衡服务器直接通信,即`用户解析服务器域名`时得到是`负载均衡服务器ip`

****

#### Socks代理

- 当通过代理服务器访问到一个网址时,socks服务器是起到了一个`中间人的身份`,他分别与`浏览器/被访问的网址`通讯然后将`获取到的结果告知一方`
- 配置好socks代理后,无需制定被访问目标,直接在浏览器的地址栏`输入地址`就能访问任意网站
- `原理`:socks代理中有一个`交互协议`,当准备访问一个网站时并敲击回车时,浏览器会先发送一个`被访问目标的基本信息`给`socks服务端`
- socks服务端`解析`了这个信息以后,会`代替浏览器`去访问目标网站,并将`访问结果回复`给浏览器端

****

#### 代理和转发`区别`

- `代理`:需要socks协议支持,`一对多`帮他人访问网络
- `端口转发`:无需协议支持,`一对一`,帮他人访问主机的某个端口

****

#### neoreg工具

- neoreg主要是把`内网服务器的端口`通过`http/https隧道`转发到本机,形成一个回路
- 用于目标服务器`在内网`或做了`端口策略`的情况下连接目标服务器内部开放端口
- 利用webshell建立一个`socks代理`进行`内网穿透`,服务器必须支持aspx,php,jsp等一种
- neoreg分为`服务端`和`客户端`,两部分组成,服务端有aspx,php,jsp,客户端则由python编写
- 工作`原理`:`python`客户端在本地`监听一个端口`,`提供socks服务`,并将数据通过`http/https`发送到服务端上,并从服务端上用`socks实现转发`

```cmd
 #设置密码生成 tunnel.(aspx|ashx|jsp|jspx|php) 并上传到WEB服务器
 python neoreg.py generate -k password
 
 #使用 neoreg.py 连接 WEB 服务器，在本地建立 socks5 代理
 python3 neoreg.py -k password -u http://xx/tunnel.php
```

****

#### msf路由转发

- MSF中自带路由转发功能,在已经获取到`meterpreter shell`的基础上添加一条去往`内网`的路由
- 直接使用`msf`去访问原本不能直接访问到的内网资源,当路由可达了使用msf进行内网探测
- `获得msf session会话`->`获取内网地址`->`在msf中添加内网网段路由`

```cmd
#添加去往内网网段的转发路由
run autoroute -s 内网网段
#查看路由添加情况
run autoroute -p
```

****

#### proxychains代理(linux)

- 在使用工具之前对工具进行配置,配置文件:`/etc/proxychains.conf`
- 删除`dynamic_chain`前面的注释
- 在底部添加要代理的服务器

```cmd
#测试代理服务器能否正常工作
cp /usr/lib/proxychains3/proxyresolv /usr/bin/
proxyresolv www.baidu.com

#使用proxychains启动任意软件
proxychains xxxxx
```

****

#### Windows代理

- `Proxifier`
- `Sockscap`

****

